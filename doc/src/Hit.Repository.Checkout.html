<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | Provides functions that change repository state between branches and commits</span><span>
</span><a name="line-2"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hit</span><span class="hs-operator">.</span><span class="hs-identifier">Repository</span><span class="hs-operator">.</span><span class="hs-identifier">Checkout</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-3"></a><span>    </span><a href="Hit.Repository.Checkout.html#makeHashCheckout"><span class="hs-identifier hs-var">makeHashCheckout</span></a><span class="hs-special">,</span><span>
</span><a name="line-4"></a><span>    </span><a href="Hit.Repository.Checkout.html#changeBranch"><span class="hs-identifier hs-var">changeBranch</span></a><span class="hs-special">,</span><span>
</span><a name="line-5"></a><span>    </span><a href="Hit.Repository.Checkout.html#changeToCommit"><span class="hs-identifier hs-var">changeToCommit</span></a><span>
</span><a name="line-6"></a><span class="hs-special">)</span><span class="hs-keyword">where</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><a href="Hit.Common.Data.html"><span class="hs-identifier">Hit</span><span class="hs-operator">.</span><span class="hs-identifier">Common</span><span class="hs-operator">.</span><span class="hs-identifier">Data</span></a><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">Class</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">Except</span><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><a href="Hit.Objects.html"><span class="hs-identifier">Hit</span><span class="hs-operator">.</span><span class="hs-identifier">Objects</span></a><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><a href="Hit.Repository.General.References.html"><span class="hs-identifier">Hit</span><span class="hs-operator">.</span><span class="hs-identifier">Repository</span><span class="hs-operator">.</span><span class="hs-identifier">General</span><span class="hs-operator">.</span><span class="hs-identifier">References</span></a><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><a href="Hit.Repository.Changes.html"><span class="hs-identifier">Hit</span><span class="hs-operator">.</span><span class="hs-identifier">Repository</span><span class="hs-operator">.</span><span class="hs-identifier">Changes</span></a><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><a href="Hit.Common.Repository.html"><span class="hs-identifier">Hit</span><span class="hs-operator">.</span><span class="hs-identifier">Common</span><span class="hs-operator">.</span><span class="hs-identifier">Repository</span></a><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><a href="Hit.Repository.Directory.html"><span class="hs-identifier">Hit</span><span class="hs-operator">.</span><span class="hs-identifier">Repository</span><span class="hs-operator">.</span><span class="hs-identifier">Directory</span></a><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><a href="Hit.Common.File.html"><span class="hs-identifier">Hit</span><span class="hs-operator">.</span><span class="hs-identifier">Common</span><span class="hs-operator">.</span><span class="hs-identifier">File</span></a><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><a href="Hit.Store.html"><span class="hs-identifier">Hit</span><span class="hs-operator">.</span><span class="hs-identifier">Store</span></a><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><a href="Hit.Common.List.html"><span class="hs-identifier">Hit</span><span class="hs-operator">.</span><span class="hs-identifier">Common</span><span class="hs-operator">.</span><span class="hs-identifier">List</span></a><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><a href="Hit.Repository.General.Data.html"><span class="hs-identifier">Hit</span><span class="hs-operator">.</span><span class="hs-identifier">Repository</span><span class="hs-operator">.</span><span class="hs-identifier">General</span><span class="hs-operator">.</span><span class="hs-identifier">Data</span></a><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><a href="Hit.Repository.General.Branch.html"><span class="hs-identifier">Hit</span><span class="hs-operator">.</span><span class="hs-identifier">Repository</span><span class="hs-operator">.</span><span class="hs-identifier">General</span><span class="hs-operator">.</span><span class="hs-identifier">Branch</span></a><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-identifier">applyNewFile</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hit.Objects.html#Tree"><span class="hs-identifier hs-type">Tree</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hit.Common.Data.html#ExIO"><span class="hs-identifier hs-type">ExIO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-24"></a><a name="applyNewFile"><a href="Hit.Repository.Checkout.html#applyNewFile"><span class="hs-identifier">applyNewFile</span></a></a><span> </span><a name="local-6989586621679080555"><a href="#local-6989586621679080555"><span class="hs-identifier">path</span></a></a><span> </span><a name="local-6989586621679080556"><a href="#local-6989586621679080556"><span class="hs-identifier">tree</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hit.Repository.Directory.html#findFileInTree"><span class="hs-identifier hs-var">findFileInTree</span></a><span> </span><a href="#local-6989586621679080555"><span class="hs-identifier hs-var">path</span></a><span> </span><a href="#local-6989586621679080556"><span class="hs-identifier hs-var">tree</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">fileContent</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><a href="Hit.Common.File.html#createFileWithParentDirectories"><span class="hs-identifier hs-var">createFileWithParentDirectories</span></a><span> </span><a href="#local-6989586621679080555"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-identifier">applyRemoveFile</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hit.Common.Data.html#ExIO"><span class="hs-identifier hs-type">ExIO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><a name="applyRemoveFile"><a href="Hit.Repository.Checkout.html#applyRemoveFile"><span class="hs-identifier">applyRemoveFile</span></a></a><span> </span><a name="local-6989586621679080557"><a href="#local-6989586621679080557"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hit.Repository.Directory.html#removeFileFromTree"><span class="hs-identifier hs-var">removeFileFromTree</span></a><span> </span><a href="#local-6989586621679080557"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-identifier">applyChange</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Hit.Objects.html#Tree"><span class="hs-identifier hs-type">Tree</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hit.Repository.General.Data.html#Change"><span class="hs-identifier hs-type">Change</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hit.Common.Data.html#ExIO"><span class="hs-identifier hs-type">ExIO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-30"></a><a name="applyChange"><a href="Hit.Repository.Checkout.html#applyChange"><span class="hs-identifier">applyChange</span></a></a><span> </span><a name="local-6989586621679080558"><a href="#local-6989586621679080558"><span class="hs-identifier">tree</span></a></a><span> </span><span class="hs-special">(</span><a href="Hit.Repository.General.Data.html#Removed"><span class="hs-identifier hs-var">Removed</span></a><span> </span><a name="local-6989586621679080559"><a href="#local-6989586621679080559"><span class="hs-identifier">path</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hit.Repository.Checkout.html#applyNewFile"><span class="hs-identifier hs-var">applyNewFile</span></a><span> </span><a href="#local-6989586621679080559"><span class="hs-identifier hs-var">path</span></a><span> </span><a href="#local-6989586621679080558"><span class="hs-identifier hs-var">tree</span></a><span>
</span><a name="line-31"></a><span class="hs-identifier">applyChange</span><span> </span><a name="local-6989586621679080560"><a href="#local-6989586621679080560"><span class="hs-identifier">tree</span></a></a><span> </span><span class="hs-special">(</span><a href="Hit.Repository.General.Data.html#New"><span class="hs-identifier hs-var">New</span></a><span> </span><a name="local-6989586621679080561"><a href="#local-6989586621679080561"><span class="hs-identifier">path</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hit.Repository.Checkout.html#applyRemoveFile"><span class="hs-identifier hs-var">applyRemoveFile</span></a><span> </span><a href="#local-6989586621679080561"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-32"></a><span class="hs-identifier">applyChange</span><span> </span><a name="local-6989586621679080562"><a href="#local-6989586621679080562"><span class="hs-identifier">tree</span></a></a><span> </span><span class="hs-special">(</span><a href="Hit.Repository.General.Data.html#Modified"><span class="hs-identifier hs-var">Modified</span></a><span> </span><a name="local-6989586621679080563"><a href="#local-6989586621679080563"><span class="hs-identifier">path</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hit.Repository.Checkout.html#applyRemoveFile"><span class="hs-identifier hs-var">applyRemoveFile</span></a><span> </span><a href="#local-6989586621679080563"><span class="hs-identifier hs-var">path</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="Hit.Repository.Checkout.html#applyNewFile"><span class="hs-identifier hs-var">applyNewFile</span></a><span> </span><a href="#local-6989586621679080563"><span class="hs-identifier hs-var">path</span></a><span> </span><a href="#local-6989586621679080562"><span class="hs-identifier hs-var">tree</span></a><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-identifier">makeChangesCheckout</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Hit.Repository.General.Data.html#Change"><span class="hs-identifier hs-type">Change</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hit.Objects.html#Tree"><span class="hs-identifier hs-type">Tree</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hit.Common.Data.html#ExIO"><span class="hs-identifier hs-type">ExIO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-35"></a><a name="makeChangesCheckout"><a href="Hit.Repository.Checkout.html#makeChangesCheckout"><span class="hs-identifier">makeChangesCheckout</span></a></a><span> </span><a name="local-6989586621679080564"><a href="#local-6989586621679080564"><span class="hs-identifier">changes</span></a></a><span> </span><a name="local-6989586621679080565"><a href="#local-6989586621679080565"><span class="hs-identifier">tree</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldM</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080566"><a href="#local-6989586621679080566"><span class="hs-identifier">acc</span></a></a><span> </span><a name="local-6989586621679080567"><a href="#local-6989586621679080567"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hit.Repository.Checkout.html#applyChange"><span class="hs-identifier hs-var">applyChange</span></a><span> </span><a href="#local-6989586621679080565"><span class="hs-identifier hs-var">tree</span></a><span> </span><a href="#local-6989586621679080567"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080564"><span class="hs-identifier hs-var">changes</span></a><span> </span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-identifier">makeTreeCheckout</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Hit.Objects.html#Tree"><span class="hs-identifier hs-type">Tree</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hit.Common.Data.html#ExIO"><span class="hs-identifier hs-type">ExIO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-38"></a><a name="makeTreeCheckout"><a href="Hit.Repository.Checkout.html#makeTreeCheckout"><span class="hs-identifier">makeTreeCheckout</span></a></a><span> </span><a name="local-6989586621679080568"><a href="#local-6989586621679080568"><span class="hs-identifier">tree</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span class="hs-special">{</span><span>
</span><a name="line-39"></a><span>    </span><a name="local-6989586621679080569"><a href="#local-6989586621679080569"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Hit.Common.Repository.html#getRepositoryDirectory"><span class="hs-identifier hs-var">getRepositoryDirectory</span></a><span class="hs-special">;</span><span>
</span><a name="line-40"></a><span>    </span><a name="local-6989586621679080570"><a href="#local-6989586621679080570"><span class="hs-identifier">curr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Hit.Repository.Directory.html#getTree"><span class="hs-identifier hs-var">getTree</span></a><span> </span><a href="#local-6989586621679080569"><span class="hs-identifier hs-var">path</span></a><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">;</span><span>
</span><a name="line-41"></a><span>    </span><a name="local-6989586621679080571"><a href="#local-6989586621679080571"><span class="hs-identifier">ch</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Hit.Repository.Changes.html#compareDirectoryTrees"><span class="hs-identifier hs-var">compareDirectoryTrees</span></a><span> </span><a href="#local-6989586621679080569"><span class="hs-identifier hs-var">path</span></a><span> </span><a href="#local-6989586621679080570"><span class="hs-identifier hs-var">curr</span></a><span> </span><a href="#local-6989586621679080568"><span class="hs-identifier hs-var">tree</span></a><span class="hs-special">;</span><span>
</span><a name="line-42"></a><span>    </span><a href="Hit.Repository.Checkout.html#makeChangesCheckout"><span class="hs-identifier hs-var">makeChangesCheckout</span></a><span> </span><a href="#local-6989586621679080571"><span class="hs-identifier hs-var">ch</span></a><span> </span><a href="#local-6989586621679080568"><span class="hs-identifier hs-var">tree</span></a><span>
</span><a name="line-43"></a><span class="hs-special">}</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span class="hs-comment">-- | Changes repository state to be like in the given commit hash</span><span>
</span><a name="line-46"></a><span class="hs-identifier">makeHashCheckout</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Hit.Common.Data.html#Hash"><span class="hs-identifier hs-type">Hash</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hit.Common.Data.html#ExIO"><span class="hs-identifier hs-type">ExIO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-47"></a><a name="makeHashCheckout"><a href="Hit.Repository.Checkout.html#makeHashCheckout"><span class="hs-identifier">makeHashCheckout</span></a></a><span> </span><a name="local-6989586621679080572"><a href="#local-6989586621679080572"><span class="hs-identifier">hash</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hit.Repository.General.References.html#getVersion"><span class="hs-identifier hs-var">getVersion</span></a><span> </span><a href="#local-6989586621679080572"><span class="hs-identifier hs-var">hash</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><a href="Hit.Repository.Checkout.html#makeTreeCheckout"><span class="hs-identifier hs-var">makeTreeCheckout</span></a><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span class="hs-identifier">makeBranchCheckout</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Hit.Common.Data.html#Branch"><span class="hs-identifier hs-type">Branch</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hit.Common.Data.html#ExIO"><span class="hs-identifier hs-type">ExIO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-50"></a><a name="makeBranchCheckout"><a href="Hit.Repository.Checkout.html#makeBranchCheckout"><span class="hs-identifier">makeBranchCheckout</span></a></a><span> </span><a name="local-6989586621679080573"><a href="#local-6989586621679080573"><span class="hs-identifier">branch</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hit.Repository.General.References.html#getBranchCommitHash"><span class="hs-identifier hs-var">getBranchCommitHash</span></a><span> </span><a href="#local-6989586621679080573"><span class="hs-identifier hs-var">branch</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><a href="Hit.Repository.Checkout.html#makeHashCheckout"><span class="hs-identifier hs-var">makeHashCheckout</span></a><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-comment">-- | Changes the current branch and restores repository state to be exaclty as in the last commit from the given branch</span><span>
</span><a name="line-53"></a><span class="hs-identifier">changeBranch</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Hit.Common.Data.html#Branch"><span class="hs-identifier hs-type">Branch</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hit.Common.Data.html#ExIO"><span class="hs-identifier hs-type">ExIO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-54"></a><a name="changeBranch"><a href="Hit.Repository.Checkout.html#changeBranch"><span class="hs-identifier">changeBranch</span></a></a><span> </span><a name="local-6989586621679080574"><a href="#local-6989586621679080574"><span class="hs-identifier">branch</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hit.Repository.General.Branch.html#doesBranchExist"><span class="hs-identifier hs-var">doesBranchExist</span></a><span> </span><a href="#local-6989586621679080574"><span class="hs-identifier hs-var">branch</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080575"><a href="#local-6989586621679080575"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679080575"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">throwE</span><span> </span><span class="hs-string">&quot;Branch does not exist&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="Hit.Repository.General.Branch.html#isCurrentBranch"><span class="hs-identifier hs-var">isCurrentBranch</span></a><span> </span><a href="#local-6989586621679080574"><span class="hs-identifier hs-var">branch</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080576"><a href="#local-6989586621679080576"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679080576"><span class="hs-identifier hs-var">r</span></a><span> </span><span>
</span><a name="line-55"></a><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">throwE</span><span> </span><span class="hs-string">&quot;Cannot checkout to current branch&quot;</span><span>
</span><a name="line-56"></a><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="Hit.Repository.Changes.html#getRepositoryChanges"><span class="hs-identifier hs-var">getRepositoryChanges</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080577"><a href="#local-6989586621679080577"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679080577"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span>
</span><a name="line-57"></a><span>        </span><span class="hs-keyword">then</span><span> </span><a href="Hit.Repository.Checkout.html#makeBranchCheckout"><span class="hs-identifier hs-var">makeBranchCheckout</span></a><span> </span><a href="#local-6989586621679080574"><span class="hs-identifier hs-var">branch</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="Hit.Repository.General.Branch.html#changeCurrentBranch"><span class="hs-identifier hs-var">changeCurrentBranch</span></a><span> </span><a href="#local-6989586621679080574"><span class="hs-identifier hs-var">branch</span></a><span> </span><span>
</span><a name="line-58"></a><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">throwE</span><span> </span><span class="hs-string">&quot;Your directory has changes that will be lost after checkout. Commit them first. Checkout aborted&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-comment">-- | Changes repository state to be like in the given commit hash.</span><span>
</span><a name="line-61"></a><span class="hs-comment">-- This sets repository to a deteached head mode</span><span>
</span><a name="line-62"></a><span class="hs-identifier">changeToCommit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Hit.Common.Data.html#Hash"><span class="hs-identifier hs-type">Hash</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hit.Common.Data.html#ExIO"><span class="hs-identifier hs-type">ExIO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-63"></a><a name="changeToCommit"><a href="Hit.Repository.Checkout.html#changeToCommit"><span class="hs-identifier">changeToCommit</span></a></a><span> </span><a name="local-6989586621679080578"><a href="#local-6989586621679080578"><span class="hs-identifier">hash</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hit.Repository.Changes.html#getRepositoryChanges"><span class="hs-identifier hs-var">getRepositoryChanges</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080579"><a href="#local-6989586621679080579"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679080579"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span>
</span><a name="line-64"></a><span>    </span><span class="hs-keyword">then</span><span> </span><a href="Hit.Repository.General.References.html#getFullHash"><span class="hs-identifier hs-var">getFullHash</span></a><span> </span><a href="#local-6989586621679080578"><span class="hs-identifier hs-var">hash</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080580"><a href="#local-6989586621679080580"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hit.Repository.Checkout.html#makeHashCheckout"><span class="hs-identifier hs-var">makeHashCheckout</span></a><span> </span><a href="#local-6989586621679080580"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679080580"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><a href="Hit.Repository.General.References.html#writeCommitDeteachedHead"><span class="hs-identifier hs-var">writeCommitDeteachedHead</span></a><span>
</span><a name="line-65"></a><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">throwE</span><span> </span><span class="hs-string">&quot;Your directory has changes that will be lost after checkout. Commit them first. Checkout aborted&quot;</span><span class="hs-special">)</span></pre></body></html>